(this["webpackJsonp@godwoken-polyman/client"]=this["webpackJsonp@godwoken-polyman/client"]||[]).push([[0],{21:function(t,e,n){"use strict";(function(t){var o=n(88),a=n.n(o),r=n(29);e.a={convertTimestamp:t=>"string"===typeof t?new Date(parseInt(t)).toLocaleTimeString():new Date(t).toLocaleTimeString(),hex2dec:t=>BigInt(t).toString(10),dec2hex:t=>BigInt(t).toString(16),shannon2CKB:t=>a.a.divide(a.a.BigInt(t),a.a.BigInt(1e8)).toString(10),CKB2shannon:t=>BigInt(t).toString(10)+"00000000",isObjectInArray:(t,e)=>{for(let n=0;n<e.length;n++)if(JSON.stringify(e[n])===JSON.stringify(t))return!0;return!1},arrayBufferToBuffer:e=>{for(var n=t.alloc(e.byteLength),o=new Uint8Array(e),a=0;a<n.length;++a)n[a]=o[a];return n},get_env_mode:()=>"development"===r.mode?"development":"production",asyncSleep:(t=0)=>new Promise((e=>setTimeout(e,t))),readDataFromFile:t=>new Promise(((e,n)=>{const o=new FileReader;o.onload=t=>{const n=t.target.result;e({status:"ok",data:n})},o.onerror=t=>{e({status:"failed",error:t})},o.onabort=()=>{e({status:"failed",error:"user abort."})},o.readAsBinaryString(t)}))}}).call(this,n(4).Buffer)},252:function(t,e,n){},272:function(t,e,n){},275:function(t,e,n){},283:function(t,e){},29:function(t){t.exports=JSON.parse('{"development_server_url":"http://localhost:6101","web3_server_url":"http://localhost:8024","production_server_url":"https://your.domain","mode":"development"}')},312:function(t,e){},314:function(t,e){},338:function(t,e){},380:function(t,e){},382:function(t,e){},414:function(t,e){},419:function(t,e){},421:function(t,e){},428:function(t,e){},430:function(t,e){},441:function(t,e){},455:function(t,e){},554:function(t,e,n){},759:function(t,e,n){"use strict";n.r(e);var o=n(0),a=n.n(o),r=n(32),s=n.n(r),c=(n(252),n(244)),i=n(12),l=n(11),d=n.n(l),u=n(29),h=n(21);d.a.defaults.withCredentials=!0;var p=class{constructor(){this.base_url=void 0,this.base_url="development"===h.a.get_env_mode()?u.development_server_url:u.production_server_url}async getRollupTypeHash(){return(await d.a.get(`${this.base_url}/get_rollup_type_hash`,{params:{}})).data}async getEthAccountLockConfig(){return(await d.a.get(`${this.base_url}/get_eth_acccount_lock`,{params:{}})).data}async getBalance(t){return(await d.a.get(`${this.base_url}/get_layer2_balance`,{params:{eth_address:t}})).data}async getSudtBalance(t){return(await d.a.get(`${this.base_url}/get_layer2_sudt_balance`,{params:{eth_address:t}})).data}async issueToken(){return(await d.a.get(`${this.base_url}/issue_token`,{params:{}})).data}async getSudtToken(){return(await d.a.get(`${this.base_url}/get_sudt_token`,{})).data}async getSudtTokenTotalAmount(){return(await d.a.get(`${this.base_url}/get_sudt_token_total_amount`,{})).data}async deposit(t){return(await d.a.get(`${this.base_url}/deposit`,{params:{eth_address:t}})).data}async deposit_sudt(t){return(await d.a.get(`${this.base_url}/deposit_sudt`,{params:{eth_address:t}})).data}async transfer(t,e,n,o){return(await d.a.post(`${this.base_url}/transfer`,{data:{to_id:t,amount:e,fee:n,eth_address:o}})).data}async deployContract(t,e){return(await d.a.post(`${this.base_url}/deploy_contract`,{data:{contract_code:t,eth_address:e}})).data}async deployErc20ProxyContract(t){return(await d.a.post(`${this.base_url}/deploy_erc20_proxy_contract`,{data:{eth_address:t}})).data}async deploySudtContract(){return(await d.a.post(`${this.base_url}/deploy_sudt_contract`,{data:{}})).data}async sendL2Transaction(t,e,n,o){return(await d.a.post(`${this.base_url}/send_l2_tx`,{data:{raw_l2tx:t,signature:e,type:n,l2_script_args:o}})).data}async getTransactionReceipt(t){return(await d.a.get(`${this.base_url}/get_tx_receipt`,{params:{tx_hash:t}})).data}async getContractAddrByAccountId(t){return(await d.a.get(`${this.base_url}/get_contract_addr_by_account_id`,{params:{account_id:t}})).data}async getChainId(){return(await d.a.get(`${this.base_url}/get_chain_id`,{params:{}})).data}};d.a.defaults.withCredentials=!1;class g{constructor(){this.url=void 0,this.url=u.web3_server_url}async getBalance(t){return(await d.a.post(this.url,{jsonrpc:"2.0",id:+new Date,method:"eth_getBalance",params:[t]},{headers:{"Content-Type":"application/json"}})).data.result}async getTransactionReceipt(t){return(await d.a.post(this.url,{jsonrpc:"2.0",id:+new Date,method:"eth_getTransactionReceipt",params:[t]},{headers:{"Content-Type":"application/json"}})).data.result}async waitForTransactionReceipt(t,e=300,n=3){for(let o=0;o<e;o+=n){const e=await this.getTransactionReceipt(t);if(console.log(`keep fetching tx_receipt with ${t}, waited for ${o} seconds`),await h.a.asyncSleep(1e3*n),null!==e)return}throw new Error(`cannot fetch tx_receipt with tx ${t} in ${e} seconds`)}}var x={page:{maxWidth:"700px",margin:"atuo",textAlign:"center"},content:{width:"100%",marginTop:"20px",textAlign:"left"},main_color:{color:"#3CC68A"},background_color:{color:"#282c34"},wide_card:{padding:"10px",textAlign:"left"},wide_card_title:{color:"#3CC68A",textAlign:"center"},blockquote:{background:"#f9f9f9",borderLeft:"10px solid #3CC68A",margin:"1.5em 10px",padding:"1em 2em",color:"black"},clear_path:{clear:"both"},li:{listStyleType:"none",marginLeft:"0"},ul:{listStyleType:"none",paddingLeft:"0"},status_bar:{width:"100%",padding:"5px",margin:"10px 0px",clear:"both",justifyContent:"center"},status_bar_title:{float:"left",fontSize:"16px",fontWeight:"bolder"},status_bar_btn:{float:"right",textAlign:"center",marginRight:"20px"},modal:{maxWidth:"700px",maxHeight:"80%",overflowY:"scroll",padding:"20px",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto"},paper:{backgroundColor:"gray",border:"2px solid #000",boxShadow:"10px",padding:"10px",width:"100%",outline:"none"},hidden_btn:{width:"100%",border:"0",backgroundColor:"rgb(0,0,0, 0)",height:"0",cursor:"auto"},single_line_code:{background:"white",color:"gray",padding:"2px",borderRadius:"5px"},explain_text:{fontSize:"14px",color:"gray",margin:"20px"},input_wrap:{padding:"2px 5px",marginBottom:"10px",display:"block",background:"white"},input:{width:"100%",outline:"none",fontSize:"14px",border:"0",overflowX:"scroll",verticalAlign:"text-bottom"},describe_img_wrapper:{maxWidth:"100px",margin:"40px auto"},describe_img:{width:"100%",height:"100%",background:"#282c34"},describe_img_footnote:{textAlign:"center",fontSize:"11px"}},b=n(68),j=(n(272),n(1));const f={...x,loader:{border:"4px solid rgba(60, 198, 138, 0.2)",borderLeft:"4px solid",animation:"load 1s infinite linear",borderRadius:"50%",width:"25px",height:"25px",margin:"0 auto"},btn:{padding:"0.5rem 1rem",fontSize:"12px",color:"white",borderRadius:"6px",border:"1px solid "+x.main_color.color,outline:"none",backgroundColor:"rgb(255,255,255, 0)",cursor:"pointer"},btndiv:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"},btn_hover:{padding:"0.5rem 1rem",fontSize:"12px",color:"white",borderRadius:"6px",border:"1px solid "+x.main_color.color,outline:"none",backgroundColor:x.main_color.color,cursor:"pointer"}},y=()=>Object(j.jsx)("div",{style:f.loader});function _(t){const[e,n]=Object(o.useState)(0),[a,r]=Object(o.useState)(0),s=Object(o.useRef)(null),c=void 0===t.isLoading,[i,l]=Object(o.useState)(!1),[d,u]=Object(o.useState)(!c&&t.isLoading),[h,p]=Object(o.useState)(!1);Object(o.useEffect)((()=>{if(void 0!==t.isLoading&&u(t.isLoading),d&&l(!0),!d&&i){const t=setTimeout((()=>{l(!1)}),400);return()=>{clearTimeout(t)}}}),[t.isLoading,d,i]);const g=Object(b.b)({opacity:i?1:0}),x=Object(b.b)({opacity:i?0:1}),_=()=>{p(!h)},m={...{...h?f.btn_hover:f.btn,...e&&a?{width:`${e}px`,height:`${a}px`}:{}},..."undefined"===t.custom_style?{}:t.custom_style};return Object(j.jsx)("button",{style:m,onClick:async()=>{c&&u(!0),await t.onClick(),c&&u(!1)},onMouseEnter:_,onMouseLeave:_,ref:s,children:i?Object(j.jsx)(b.a.div,{style:g,children:Object(j.jsx)(y,{})}):Object(j.jsx)(b.a.div,{style:x,children:t.text})})}var m=n(40);n(274),n(275);const w={...x,panel:{},toast:{padding:"10px",fontSize:"14px"}};function O(){return Object(j.jsx)("div",{children:Object(j.jsx)(m.a,{style:w.panel,toastStyle:w.toast})})}const k=(t,e)=>{switch(e){case"error":m.b.error(t);break;case"success":m.b.success(t);break;case"warning":m.b.warn(t);break;case"info":m.b.info(t);break;case"dark":m.b.dark(t);break;default:m.b.error(t)}};var S=n(780),v=n(782),C=n(781),$=n(779);const L=function(t,e,n,a){const[r,s]=a||[];if(r===s&&"number"===typeof r)throw new Error("Only define this when the icon is not a square");const c=function({sx:t,...o},c){const i=a?{width:r,height:s,...t}:t;return Object(j.jsx)($.a,{viewBox:n,...o,ref:c,children:e,sx:i})};return c.displayName=`Icon (${t})`,Object(o.memo)(Object(o.forwardRef)(c))}("MetaMask",Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("path",{d:"M0 12C0 5.373 5.373 0 12 0h24c6.627 0 12 5.373 12 12v24c0 6.627-5.373 12-12 12H12C5.373 48 0 42.627 0 36V12z",fill:"#fff"}),Object(j.jsx)("path",{d:"M38.709 10l-11.8 8.75 2.195-5.157L38.709 10z",fill:"#E17726",stroke:"#E17726",strokeLinecap:"round",strokeLinejoin:"round"}),Object(j.jsx)("path",{d:"M11.493 10l11.694 8.832-2.09-5.239L11.494 10zM34.464 30.288l-3.14 4.807 6.722 1.855 1.926-6.557-5.508-.105zM10.247 30.393l1.914 6.557 6.71-1.855-3.127-4.807-5.497.105z",fill:"#E27625",stroke:"#E27625",strokeLinecap:"round",strokeLinejoin:"round"}),Object(j.jsx)("path",{d:"M18.509 22.168l-1.867 2.824 6.652.303-.222-7.175-4.563 4.048zM31.696 22.168l-4.633-4.13-.152 7.257 6.652-.303-1.867-2.824zM18.872 35.095l4.027-1.948-3.466-2.707-.56 4.655zM27.31 33.147l4.014 1.948-.549-4.655-3.466 2.707z",fill:"#E27625",stroke:"#E27625",strokeLinecap:"round",strokeLinejoin:"round"}),Object(j.jsx)("path",{d:"M31.322 35.095l-4.015-1.948.327 2.613-.035 1.108 3.723-1.773zM18.87 35.095l3.735 1.773-.023-1.108.315-2.613-4.026 1.948z",fill:"#D5BFB2",stroke:"#D5BFB2",strokeLinecap:"round",strokeLinejoin:"round"}),Object(j.jsx)("path",{d:"M22.674 28.713l-3.338-.98 2.358-1.085.98 2.065zM27.528 28.713l.98-2.065 2.37 1.085-3.35.98z",fill:"#233447",stroke:"#233447",strokeLinecap:"round",strokeLinejoin:"round"}),Object(j.jsx)("path",{d:"M18.87 35.095l.583-4.806-3.71.104 3.127 4.702zM30.75 30.288l.571 4.807 3.14-4.701-3.712-.105zM33.566 24.992l-6.652.303.618 3.418.98-2.065 2.37 1.085 2.684-2.741zM19.336 27.733l2.357-1.085.98 2.065.619-3.418-6.652-.303 2.696 2.741z",fill:"#CC6228",stroke:"#CC6228",strokeLinecap:"round",strokeLinejoin:"round"}),Object(j.jsx)("path",{d:"M16.64 24.992l2.79 5.448-.094-2.707-2.696-2.741zM30.874 27.733l-.105 2.707 2.79-5.448-2.685 2.741zM23.29 25.295l-.618 3.418.781 4.037.176-5.32-.339-2.135zM26.912 25.295l-.327 2.123.163 5.332.782-4.037-.619-3.418z",fill:"#E27525",stroke:"#E27525",strokeLinecap:"round",strokeLinejoin:"round"}),Object(j.jsx)("path",{d:"M27.528 28.713l-.782 4.037.56.397 3.466-2.707.105-2.707-3.35.98zM19.336 27.733l.094 2.707 3.466 2.707.56-.397-.782-4.037-3.338-.98z",fill:"#F5841F",stroke:"#F5841F",strokeLinecap:"round",strokeLinejoin:"round"}),Object(j.jsx)("path",{d:"M27.6 36.868l.035-1.108-.303-.257h-4.458l-.292.257.023 1.108-3.734-1.773 1.307 1.073L22.827 38h4.54l2.66-1.832 1.296-1.073-3.723 1.773z",fill:"#C0AC9D",stroke:"#C0AC9D",strokeLinecap:"round",strokeLinejoin:"round"}),Object(j.jsx)("path",{d:"M27.308 33.147l-.56-.397h-3.29l-.561.397-.315 2.613.292-.257h4.458l.303.257-.327-2.613z",fill:"#161616",stroke:"#161616",strokeLinecap:"round",strokeLinejoin:"round"}),Object(j.jsx)("path",{d:"M39.211 19.322l.992-4.83L38.71 10l-11.402 8.458 4.388 3.71 6.197 1.809 1.365-1.599-.595-.431.945-.864-.723-.56.945-.723-.619-.478zM10 14.492l1.004 4.83-.642.478.957.723-.724.56.945.864-.595.431 1.366 1.599 6.197-1.809 4.388-3.71L11.494 10 10 14.492z",fill:"#763E1A",stroke:"#763E1A",strokeLinecap:"round",strokeLinejoin:"round"}),Object(j.jsx)("path",{d:"M37.896 23.977L31.7 22.168l1.867 2.824-2.789 5.448 3.688-.047h5.508l-2.077-6.416zM18.51 22.168l-6.198 1.809-2.065 6.416h5.496l3.688.047-2.789-5.448 1.867-2.824zM26.913 25.295l.397-6.837 1.797-4.865h-8.006l1.798 4.865.396 6.837.152 2.147.012 5.308h3.29l.013-5.308.151-2.147z",fill:"#F5841F",stroke:"#F5841F",strokeLinecap:"round",strokeLinejoin:"round"})]}),"0 0 48 48");var M=n(234),z=n(128),A=n.n(z),B=n(237),N=n.n(B),T=n(236),J=n.n(T);const E={wallet_container:{maxWidth:"300px",maxHeigth:"20px",margin:"40px auto",display:"flex",padding:"5px",alignItems:"center",borderRadius:"30px",justifyContent:"center",backgroundColor:"rgb(60, 198, 138)"},status:{fontSize:"18px",color:"gray",margin:"20px"},status_item:{boder:"1px solid gray",padding:"5px",marginRight:"10px"},balance:{color:"whitesmoke",fontSize:"20px"},dark_green:{color:"#065a06"}};function F(t){const{onUpdateWalletAddress:e}=t;var{triggerUpdateBalanceMethod:n}=t;const[a,r]=Object(o.useState)(),[s,c]=Object(o.useState)(),[i,l]=Object(o.useState)(),[d,u]=Object(o.useState)(!0),[x,b]=Object(o.useState)("0"),f=(J.a,E.dark_green.color,N.a,A.a,E.dark_green.color,A.a,async()=>M.a.isMetaMaskInstalled()?(await c("installed"),!0):(await c("not-installed"),!1)),y=async()=>{try{const t=await window.ethereum.request({method:"eth_chainId"});console.log(`current chain id: ${t}`);const e=new p,n=await e.getChainId();console.log(n);const o=n.data;return t!==o?(console.error(`current chain id not equals ${t} !== polyjuice chain id ${o}`),await l(!1),!1):(await l(!0),!0)}catch(t){return k(JSON.stringify(t,null,2)),!1}},m=()=>{window.ethereum.on("chainChanged",(function(t){console.log("chain_id changed!"),window.location.reload()}))},w=()=>{window.ethereum.on("accountsChanged",(function(t){t.length>0?r(t[0]):(r(void 0),c("diconnect"),k("please reconnect to metamask!"))}))},O=()=>{window.ethereum.on("connect",(function(){console.log("connect!!!"),u(!0)})),window.ethereum.on("disconnect",(function(){u(!1)}))},S=async()=>{try{await window.ethereum.request({method:"eth_requestAccounts"}),c("connected"),r(window.ethereum.selectedAddress)}catch(t){k(JSON.stringify(t,null,2)),c("connect-failed"),console.error(t)}},v=async()=>{if(!a)return;const t=new g;try{console.log(a);const e=await t.getBalance(a);if(console.log(e),!e)return console.log("balance is undefinded.");const n=BigInt(e).toString();console.log(n),await b(h.a.shannon2CKB(n)),console.log(h.a.shannon2CKB(n))}catch(e){console.log("get bablance error"),console.log(e),k(JSON.stringify(e))}};Object(o.useEffect)((()=>{n&&(n=()=>{v()}),(async()=>{if(!f())throw k("please install MetaMask!"),new Error("please install MetaMask!");console.log(window.ethereum.isConnected()),window.ethereum.isConnected()&&(console.log("is conneted..."),u(!0)),await y(),m(),w(),O(),S()})(),v()}),[]),Object(o.useEffect)((()=>{e&&e(a),v()}),[a]);return Object(j.jsxs)("div",{children:[Object(j.jsxs)("div",{style:E.wallet_container,children:[Object(j.jsx)(L,{}),Object(j.jsx)(_,{custom_style:{fontSize:"25px",fontWeight:"bolder",border:"none"},text:(t=>{const e=t.length;return 42!==e?t:t.slice(0,8)+"..."+t.slice(e-6)})(a||"Connect Wallet"),onClick:a?function(){}:S})]}),Object(j.jsx)("div",{children:Object(j.jsxs)("div",{style:E.balance,children:[" ",Object(j.jsxs)("span",{children:[x," CKB ( ",(t=>{const e=parseFloat(t)/parseFloat("10000000000");return e>0?e.toFixed(10-t.length+1):e.toFixed(2)})(x),"  pETH )"]})]})})]})}var R=n(18),I=n(85),D=n.n(I),W=n(86),P=n.n(W);const H=n(100),K={...x,container:{},method_item:{textAlign:"left",maxWidth:"700px",margin:"0 auto"},method_box:{fontSize:"14px",border:"1px solid gray",padding:"20px",textAlign:"left",maxWidth:"700px",margin:"0 auto",display:"block"},method_name:{textAlign:"left",fontSize:"16px",padding:"10px 0",color:x.main_color.color},return_value:{border:"1px solid gray",padding:"5px"},param_input:{width:"100%",padding:"5px"},submit_btn:{padding:"5px"},select_abi_file:{fontSize:"14px"},contract_addr_input_container:{maxWidth:"600px",margin:"0 auto"},contract_addr_input:{width:"100%",padding:"5px",fontSize:"16px"},setting_container:{maxWidth:"700px",border:"1px solid gray",margin:"10px auto",padding:"10px 0"},log_container:{maxWidth:"700px",border:"1px solid gray",margin:"10px auto",padding:"10px 0",textAlign:"left"},log_container_title:{fontSize:"16px",color:x.main_color.color,textAlign:"center"},log_main_area:{fontSize:"14px",textAlign:"left",padding:"10px",margin:"5px"}},q=[];function U(t){const{rollup_type_hash:e,eth_account_lock_code_hash:n,eth_account_lock_hash_type:a}=t.godwoken_config,[r,s]=(new g,Object(o.useState)(q)),[c,i]=Object(o.useState)(),[l,d]=Object(o.useState)([]);Object(o.useEffect)((()=>{}),[]);const p=()=>{const t=u.web3_server_url,o={godwoken:{rollup_type_hash:e||"",eth_account_lock:{code_hash:n||"",hash_type:"type"===a?"type":"data"}}},s=new P.a(t,o,r);return new D.a(s)};return Object(j.jsxs)("div",{style:K.container,children:[Object(j.jsxs)("div",{style:K.setting_container,children:[Object(j.jsxs)("p",{style:K.select_abi_file,children:[Object(j.jsx)("label",{children:"Upload Contract ABI\uff1a"}),Object(j.jsx)("input",{type:"file",placeholder:"abi file",onChange:async t=>{const e=await(async t=>{const e=t.target.files[0],n=await h.a.readDataFromFile(e);if(console.log(n),"ok"!==n.status)throw k("can not read contract abi from file."),new Error("can not read contract abi from file.");const o=JSON.parse(n.data);if(Array.isArray(o))return o;if("object"===typeof o&&o.abi)return o.abi;throw k("not a valid abi file!"),new Error("not a valid abi file!")})(t);await s(e)}})]}),Object(j.jsx)("p",{style:K.contract_addr_input_container,children:Object(j.jsx)("input",{type:"text",placeholder:"contract address",style:K.contract_addr_input,onChange:t=>{i(t.target.value)}})})]}),Object(j.jsxs)("div",{style:K.log_container,children:[Object(j.jsx)("div",{style:K.log_container_title,children:" Logs "}),Object(j.jsx)("div",{style:K.log_main_area,children:l.map(((t,e)=>Object(j.jsxs)("li",{children:[e,": ",t]},e)))})]}),(t=>t.filter((t=>"function"===t.type)).map(((t,e)=>{var n,o=[],a=[],r="0";const s=t=>{o[parseInt(t.target.name)]=t.target.value},i=async(t,e)=>{var n;const o=H.encodeFunctionCall(t,e),r={gasPrice:"0x0000",gas:"0x9184e72a000",to:c||"0x"+"0".repeat(40),from:window.ethereum.selectedAddress,data:o};console.log(r);const s=p(),i=await s.eth.call(r);console.log(`web3.eth.call result: ${JSON.stringify(i,null,2)}`);const l=H.decodeParameters(null===(n=t.outputs)||void 0===n?void 0:n.map((t=>t.type)),i);console.log(l);for(let c=0;c<l.__length__;c++)a[c]=l[c+""];console.log(a),k(JSON.stringify(a,null,2),"success"),await d((e=>[...e,`call "${t.name}", receive return value: ${JSON.stringify(a)}`]))},l=async(t,e)=>{const n=H.encodeFunctionCall(t,e);console.log(r);const o=t.payable?"0x"+BigInt(r).toString(16):"0x00",a={gasPrice:"0x0000",gas:"0x9184e72a000",to:c||"0x"+"0".repeat(40),from:window.ethereum.selectedAddress,value:o,data:n};console.log(a);const s=p(),i=await s.eth.sendTransaction(a);console.log(`txReceipt: ${JSON.stringify(i,null,2)}`),k("tx commited. open your console page to check txReceipt.","success"),await d((e=>[...e,`call "${t.name}", tx ${i.transactionHash} commited.`]))};return Object(j.jsxs)("div",{style:K.method_item,children:[Object(j.jsxs)("span",{style:K.method_name,children:[" ",e+1,". ",t.name," "]}),Object(j.jsxs)("li",{style:K.method_box,children:[t.payable&&Object(j.jsx)("p",{children:Object(j.jsx)("input",{style:K.param_input,onChange:t=>{console.log(t.target.value),r=Object(R.toWei)(t.target.value)},name:"value_"+e,type:"text",placeholder:"value: ETH"})}),Object(j.jsxs)("p",{children:[" ",null===(n=t.inputs)||void 0===n?void 0:n.map(((t,e)=>(o.push(""),Object(j.jsx)("li",{children:Object(j.jsx)("p",{children:Object(j.jsx)("input",{style:K.param_input,onChange:s,name:e+"",type:"text",placeholder:t.type})})},"intputs_"+e))))]}),Object(j.jsxs)("button",{style:K.submit_btn,onClick:()=>{(async(t,e)=>{if("function"!==t.type)throw new Error("expect a function");if("view"===t.stateMutability)try{await i(t,e)}catch(n){console.log(n),k(JSON.stringify(n,null,2))}if("view"!==t.stateMutability)try{await l(t,e)}catch(n){k(JSON.stringify(n,null,2))}})(t,o)},children:[" ","view"===t.stateMutability?"call":"send tx"," "]})]},e)," "]})})))(r)]})}n(554);const V={...x,header:{minHeight:"300px",margin:"10px"},address:{color:"#a0eec0"},balance:{color:"whitesmoke",fontSize:"20px"},button:{fontSize:"25px",width:"100%",maxWidth:"700px",margin:"10px",padding:"0.7rem 1.2rem"},contract_container:{width:"100%",maxWidth:"700px",margin:"30px auto",textAlign:"left",fontSize:"15px",border:"1px solid gray",color:"gray"},contract_li:{listStyleType:"none"},descrip_sudt:{width:"600px",fontSize:"13px",margin:"30px auto",textAlign:"left"},placeholder_for_experimental:{width:"700px",margin:"0 auto",marginTop:"50px"}};var X=function(){const t=Object(o.useRef)(null),[e,n]=Object(o.useState)(),[a,r]=Object(o.useState)("0"),[s,c]=Object(o.useState)(!1),[i,l]=Object(o.useState)([]),[d,x]=Object(o.useState)(),[b,f]=Object(o.useState)(),[y,m]=Object(o.useState)(),[w,$]=Object(o.useState)();Object(o.useEffect)((()=>{e&&(z(),A(),B()),N(),T()}),[e]);var L=()=>{};const M=()=>{const t=u.web3_server_url,e={godwoken:{rollup_type_hash:d||"",eth_account_lock:{code_hash:(null===b||void 0===b?void 0:b.code_hash)||"",hash_type:(null===b||void 0===b?void 0:b.hash_type)||"type"}}},n=new P.a(t,e);return new D.a(n)},z=async()=>{if(!e)return;const t=new p;try{const n=await t.getSudtBalance(e);if("ok"!==n.status)return console.error(`failed to get sudt balance from account. issue sudt token then ${JSON.stringify(n.error)}`);await r(h.a.shannon2CKB(n.data)),console.log(h.a.shannon2CKB(n.data))}catch(n){console.log("get sudt bablance error"),console.log(n),k(JSON.stringify(n))}},A=async()=>{const t=new p;try{const e=await t.getSudtToken();if(console.log(e),"ok"!==e.status)return console.log(`failed to get sudt token. ${JSON.stringify(e.error)}`);await m(e.data.sudt_token)}catch(e){console.log("get sudt token error"),console.log(e),k(JSON.stringify(e))}},B=async()=>{const t=new p;try{const e=await t.getSudtTokenTotalAmount();if(console.log(e),"ok"!==e.status)return console.log(`failed to get sudt token. ${JSON.stringify(e.error)}`);await $(e.data.total_amount)}catch(e){console.log("get sudt token amount error"),console.log(e),k(JSON.stringify(e))}},N=async()=>{const t=new p;try{const e=await t.getRollupTypeHash();if("ok"!==e.status)return k(`failed to get rollup type hash. ${JSON.stringify(e.error)}`);x(e.data)}catch(e){console.log("get rollup type hash error"),console.log(e),k(JSON.stringify(e))}},T=async()=>{const t=new p;try{const e=await t.getEthAccountLockConfig();if("ok"!==e.status)return k(`failed to get eth_account_lock config. ${JSON.stringify(e.error)}`);f(e.data)}catch(e){console.log("get eth account lock error"),console.log(e),k(JSON.stringify(e))}},J=t=>new Promise(((e,n)=>{const o=new FileReader;o.onload=t=>{const n=`0x${t.target.result}`;e({status:"ok",data:n})},o.onerror=t=>{e({status:"failed",error:t})},o.onabort=()=>{e({status:"failed",error:"user abort."})},o.readAsBinaryString(t)})),E=`\nsymbol: MLMC\nsudt token: ${R=y,R?R.slice(0,6)+"..."+R.slice(R.length-4):"undefined"}\ntotal amount: ${h.a.shannon2CKB(w||"")}\ndecimal places: 8 (same with CKB)\n`;var R;return Object(j.jsx)("div",{children:Object(j.jsx)("div",{className:"App",children:Object(j.jsxs)("header",{className:"App-header",children:[Object(j.jsx)(O,{}),Object(j.jsx)(S.a,{container:!0,spacing:3,children:Object(j.jsx)(S.a,{item:!0,xs:12,style:V.header,children:Object(j.jsx)(F,{onUpdateWalletAddress:t=>{t&&n(t)},triggerUpdateBalanceMethod:L})})}),Object(j.jsx)(S.a,{container:!0,spacing:3,children:Object(j.jsx)(S.a,{item:!0,xs:12,children:Object(j.jsx)(_,{text:"Deposit CKB",onClick:async()=>{if(!e)return k("metamask account not found.");const t=new p;try{const n=await t.deposit(e);console.log(n),"ok"===n.status?k(`your account id: ${n.data.account_id}`,"success"):k(JSON.stringify(n.error))}catch(n){k(JSON.stringify(n))}},custom_style:V.button})})}),Object(j.jsx)(S.a,{container:!0,spacing:3,children:Object(j.jsxs)(S.a,{item:!0,xs:12,children:[Object(j.jsx)(_,{text:"Deploy ETH Contract",isLoading:s,onClick:async()=>{if(!t)return k("input ref not found.");t.current.click()},custom_style:V.button}),Object(j.jsx)("input",{type:"file",ref:t,onChange:async t=>{const n=t.target.files[0];c(!0);const o=await J(n);if("ok"!==o.status)return c(!1),k("can not read contract code from file.");const a=o.data;console.log("reading contract code hex:"),console.log(a),await(async t=>{if(!t)return k("upload contract binary file first!");if(!e)return k("window.ethereum.selectedAddress not found.");new g;const n=M();try{const e={nonce:0,gasPrice:"0x0000",gas:"0x9184e72a000",to:"0x"+"0".repeat(40),from:window.ethereum.selectedAddress,value:"0x00",data:t,chainId:3};console.log(e);const o=await n.eth.sendTransaction(e);console.log(`txReceipt: ${JSON.stringify(o,null,2)}`);const a=o.contractAddress;if(console.log(`contract address: ${a}`),!a)return k(`could not find your contract address in txReceipt: ${o}`);k(`your contract address: ${a}`,"success"),l((t=>[...t,a]))}catch(o){return console.log(o),k(`could not finished signing process. \n\n ${JSON.stringify(o)}`)}})(a),c(!1)},hidden:!0})]})}),Object(j.jsx)("hr",{}),Object(j.jsx)(S.a,{container:!0,spacing:3,children:Object(j.jsxs)(S.a,{item:!0,xs:12,style:V.contract_container,children:["Contract Address:",Object(j.jsx)(v.a,{language:"javascript",style:C.a,children:i.length>0?i.join("\n"):"nothing."})]})}),Object(j.jsx)("hr",{}),Object(j.jsx)("h4",{children:" Contract Debugger (experimental) "}),Object(j.jsx)(S.a,{container:!0,spacing:3,children:Object(j.jsx)(S.a,{item:!0,xs:12,children:Object(j.jsx)(U,{godwoken_config:{rollup_type_hash:d,eth_account_lock_code_hash:null===b||void 0===b?void 0:b.code_hash,eth_account_lock_hash_type:null===b||void 0===b?void 0:b.hash_type}})})}),Object(j.jsx)("hr",{}),Object(j.jsx)("h4",{children:" Sudt Demo Section (experimental) "}),Object(j.jsx)(S.a,{container:!0,spacing:3,children:Object(j.jsx)(S.a,{item:!0,xs:12,children:Object(j.jsxs)("div",{style:V.balance,children:["Balance: ",Object(j.jsxs)("span",{children:[a," MLMC "]})]})})}),Object(j.jsx)("hr",{}),Object(j.jsx)(S.a,{container:!0,spacing:5,children:Object(j.jsx)(S.a,{item:!0,xs:12,children:Object(j.jsxs)("div",{style:V.descrip_sudt,children:[Object(j.jsx)("p",{children:"below is a simple demo to show how erc20-proxy contract works in godwoken-polyjuice."}),Object(j.jsxs)("p",{children:["the purpose of erc20-proxy contract is to mount sudt(",Object(j.jsx)("a",{href:"https://talk.nervos.org/t/rfc-simple-udt-draft-spec/4333",children:"simple user defined token"}),") in CKB with some sort of ERC20 token in ETH. so you can use ERC20 contract to transfer sudt token in CKB."]}),Object(j.jsx)("p",{children:"Note:"}),Object(j.jsx)("p",{children:"you should issue sudt token first if sudt token total amount is 0."}),Object(j.jsx)("p",{children:"depositting sudt by defaut will give you 400 sudt each time. and the capacity of ckb required is also 400 ckb, so the balance of your layer2 ckb will also increase. "}),Object(j.jsx)("hr",{}),Object(j.jsx)("p",{children:"How to deploy?"}),Object(j.jsx)("p",{children:"when you click the third button to deploy erc20-proxy contract, the kicker just retrun an predefined erc20-proxy contract bytecode and assemble an deployed tx for you. after you sign this tx with metamask(using personal sign method), the proxy will be deployed. "}),Object(j.jsxs)("p",{children:["then you can take the contract address and the abi file (you can download from ",Object(j.jsx)("a",{href:"https://github.com/nervosnetwork/godwoken-polyjuice/blob/main/solidity/erc20/SudtERC20Proxy.abi",children:"here"}),"), and interact with the contract through the simple Contract Debugger on kicker."]})]})})}),Object(j.jsx)(S.a,{container:!0,spacing:3,children:Object(j.jsxs)(S.a,{item:!0,xs:12,style:V.contract_container,children:[Object(j.jsx)("h5",{children:"My Little Meow Coin"}),Object(j.jsx)(v.a,{language:"javascript",style:C.a,children:E})]})}),Object(j.jsx)(S.a,{container:!0,spacing:3,children:Object(j.jsx)(S.a,{item:!0,xs:12,children:Object(j.jsx)(_,{text:"Issue Sudt Token",onClick:async()=>{const t=new p;try{const e=await t.issueToken();console.log(e),"ok"===e.status?k(`issue a sudt token: ${e.data.sudt_token}`,"success"):k(JSON.stringify(e.error,null,2))}catch(e){k(JSON.stringify(e))}},custom_style:V.button})})}),Object(j.jsx)(S.a,{container:!0,spacing:3,children:Object(j.jsx)(S.a,{item:!0,xs:12,children:Object(j.jsx)(_,{text:"Deposit Sudt",onClick:async()=>{if(!e)return k("metamask account not found.");const t=new p;try{const n=await t.deposit_sudt(e);console.log(n),"ok"===n.status?(k(`your account id: ${n.data.account_id}`,"success"),console.log(`res.data.l2_sudt_script_hash: ${n.data.l2_sudt_script_hash}`),await z()):k(JSON.stringify(n.error))}catch(n){k(JSON.stringify(n))}},custom_style:V.button})})}),Object(j.jsx)(S.a,{container:!0,spacing:3,children:Object(j.jsx)(S.a,{item:!0,xs:12,children:Object(j.jsx)(_,{text:"Deploy Erc20-Proxy Contract",onClick:async()=>{if(!e)return k("window.ethereum.selectedAddress not found.");const t=new p;new g;try{const o=await t.deployErc20ProxyContract(e);"ok"!==o.status&&k(JSON.stringify(o.error,null,2));const a=o.data;console.log(JSON.stringify(a,null,2));try{const t={nonce:0,gasPrice:"0x0000",gas:"0x9184e72a000",to:"0x"+"0".repeat(40),from:window.ethereum.selectedAddress,value:"0x00",data:a,chainId:3},e=M(),n=await e.eth.sendTransaction(t);console.log(`txReceipt: ${JSON.stringify(n,null,2)}`);const o=n.contractAddress;if(console.log(`contract address: ${o}`),!o)return k(`could not find your contract address in txReceipt: ${n}`);k(`your contract address: ${o}`,"success"),l((t=>[...t,o]))}catch(n){return console.log(n),k(`could not finished signing process. \n\n ${JSON.stringify(n)}`)}}catch(n){k(JSON.stringify(n))}},custom_style:V.button})})})]})})})};function Y(){return Object(j.jsx)(c.a,{children:Object(j.jsx)(i.c,{children:Object(j.jsx)(i.a,{path:"/",children:Object(j.jsx)(X,{})})})})}var G=t=>{t&&t instanceof Function&&n.e(3).then(n.bind(null,783)).then((({getCLS:e,getFID:n,getFCP:o,getLCP:a,getTTFB:r})=>{e(t),n(t),o(t),a(t),r(t)}))};s.a.render(Object(j.jsx)(a.a.StrictMode,{children:Object(j.jsx)(Y,{})}),document.getElementById("root")),G()}},[[759,1,2]]]);
//# sourceMappingURL=main.fd981816.chunk.js.map